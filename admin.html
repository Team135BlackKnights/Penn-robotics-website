<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Management</title>
    <link rel="stylesheet" href="admin/admin.css">
</head>
<body>
    <div class="container">
        <h1>Post Management</h1>
        <!-- Make Post Form -->
        <div class="form-container">
            <h2>Create Post</h2>
            <form id="make-post-form">
                <label for="title">Title</label>
                <input type="text" id="title" required>

                <label for="content">Content</label>
                <textarea id="content" required></textarea>

                <button type="submit">Create Post</button>
            </form>
        </div>

        <!-- Edit Post Form -->
        <div class="form-container">
            <h2>Edit Post</h2>
            <form id="edit-post-form">
                <label for="edit-id">Post ID</label>
                <input type="number" id="edit-id" required>

                <label for="edit-title">Title</label>
                <input type="text" id="edit-title">

                <label for="edit-content">Content</label>
                <textarea id="edit-content"></textarea>

                <button type="submit">Edit Post</button>
            </form>
        </div>

        <!-- Delete Post Form -->
        <div class="form-container">
            <h2>Delete Post</h2>
            <form id="delete-post-form">
                <label for="delete-id">Post ID</label>
                <input type="number" id="delete-id" required>

                <button type="submit">Delete Post</button>
            </form>
        </div>

        <div id="message"></div>
    </div>

    <script>
        // Check if the user is logged in when loading the page
        fetch('http://127.0.0.1:5000/check-login', {
            credentials: 'include'  // Ensure the session cookie is included
        })
        .then(response => response.json())
        .then(data => {
            if (!data.logged_in) {
                window.location.href = "login.html";  // Redirect to login page if not logged in
            } else {
                // Dynamically load app.js after confirming the user is logged in
                const script = document.createElement('script');
                script.src = 'admin/app.js';
                script.defer = true;  // Ensure it loads after the rest of the page content
                document.body.appendChild(script);
            }
        })
        .catch(error => {
            console.error('Error checking login:', error);
            window.location.href = "login.html";  // Redirect to login page on error
        });
    </script>
</body>
</html>
